const storage = new FormStorage("form", {
  name: "rsvzui-equip-lv",
  includes: ['[class="in"]'],
});

const opMap = new Map([
  ["力Lv1", 1],
  ["力Lv2", 3],
  ["力Lv3", 7],
  ["力Lv4", 13],
  ["力Lv5", 21],
  ["力Lv6", 31],
  ["力Lv7", 44],
  ["力Lv8", 60],
  ["力Lv9", 79],
  ["力Lv10", 100],
  ["力Lv1 DX", 250],
  ["力Lv1 ULT", 350],
  ["ジェーソン", 0],
  ["敏捷Lv1", 1],
  ["敏捷Lv2", 3],
  ["敏捷Lv3", 7],
  ["敏捷Lv4", 13],
  ["敏捷Lv5", 21],
  ["敏捷Lv6", 31],
  ["敏捷Lv7", 44],
  ["敏捷Lv8", 60],
  ["敏捷Lv9", 79],
  ["敏捷Lv10", 100],
  ["敏捷Lv1 DX", 250],
  ["敏捷Lv1 ULT", 350],
  ["セリー", 0],
  ["健康Lv1", 1],
  ["健康Lv2", 3],
  ["健康Lv3", 7],
  ["健康Lv4", 13],
  ["健康Lv5", 21],
  ["健康Lv6", 31],
  ["健康Lv7", 44],
  ["健康Lv8", 60],
  ["健康Lv9", 79],
  ["健康Lv10", 100],
  ["健康Lv1 DX", 250],
  ["健康Lv1 ULT", 350],
  ["トゥンガ", 0],
  ["知恵Lv1", 1],
  ["知恵Lv2", 3],
  ["知恵Lv3", 7],
  ["知恵Lv4", 13],
  ["知恵Lv5", 21],
  ["知恵Lv6", 31],
  ["知恵Lv7", 44],
  ["知恵Lv8", 60],
  ["知恵Lv9", 79],
  ["知恵Lv10", 100],
  ["知恵Lv1 DX", 250],
  ["知恵Lv1 ULT", 350],
  ["マファス", 0],
  ["知識Lv1", 1],
  ["知識Lv2", 3],
  ["知識Lv3", 7],
  ["知識Lv4", 13],
  ["知識Lv5", 21],
  ["知識Lv6", 31],
  ["知識Lv7", 44],
  ["知識Lv8", 60],
  ["知識Lv9", 79],
  ["知識Lv10", 100],
  ["知識Lv1 DX", 250],
  ["知識Lv1 ULT", 350],
  ["ティレン", 0],
  ["威厳Lv1", 1],
  ["威厳Lv2", 3],
  ["威厳Lv3", 7],
  ["威厳Lv4", 13],
  ["威厳Lv5", 21],
  ["威厳Lv6", 31],
  ["威厳Lv7", 44],
  ["威厳Lv8", 60],
  ["威厳Lv9", 79],
  ["威厳Lv10", 100],
  ["威厳Lv1 DX", 250],
  ["威厳Lv1 ULT", 350],
  ["ジム・モリ", 0],
  ["運Lv1", 1],
  ["運Lv2", 3],
  ["運Lv3", 7],
  ["運Lv4", 13],
  ["運Lv5", 21],
  ["運Lv6", 31],
  ["運Lv7", 44],
  ["運Lv8", 60],
  ["運Lv9", 79],
  ["運Lv10", 100],
  ["運Lv1 DX", 250],
  ["運Lv1 ULT", 350],
  ["ハーソン", 0],
  ["力固定", 30],
  ["力固定 DX", 230],
  ["力固定 ULT", 330],
  ["敏捷固定", 30],
  ["敏捷固定 DX", 230],
  ["敏捷固定 ULT", 330],
  ["健康固定", 30],
  ["健康固定 DX", 230],
  ["健康固定 ULT", 330],
  ["知恵固定", 30],
  ["知恵固定 DX", 230],
  ["知恵固定 ULT", 330],
  ["知識固定", 30],
  ["知識固定 DX", 230],
  ["知識固定 ULT", 330],
  ["威厳固定", 30],
  ["威厳固定 DX", 230],
  ["威厳固定 ULT", 330],
  ["運固定", 30],
  ["運固定 DX", 230],
  ["運固定 ULT", 330],
  ["力比率上昇Lv1", 30],
  ["力比率上昇Lv2", 75],
  ["精強な", 0],
  ["打撃家の", 0],
  ["ガイルート", 0],
  ["敏捷比率上昇Lv1", 30],
  ["敏捷比率上昇Lv2", 75],
  ["俊敏な", 0],
  ["遊撃隊の", 0],
  ["バルラレル", 0],
  ["健康比率上昇Lv1", 30],
  ["健康比率上昇Lv2", 75],
  ["壮健な", 0],
  ["守護者の", 0],
  ["ロシペル", 0],
  ["知恵比率上昇Lv1", 30],
  ["知恵比率上昇Lv2", 75],
  ["聡明な", 0],
  ["先導者の", 0],
  ["テマヌエル", 0],
  ["知識比率上昇Lv1", 30],
  ["知識比率上昇Lv2", 75],
  ["利発な", 0],
  ["学者の", 0],
  ["オニトルロ", 0],
  ["威厳比率上昇Lv1", 30],
  ["威厳比率上昇Lv2", 75],
  ["厳粛な", 0],
  ["指揮者の", 0],
  ["タニア", 0],
  ["運比率上昇Lv1", 30],
  ["運比率上昇Lv2", 75],
  ["幸運な", 0],
  ["夢想家の", 0],
  ["ランディス", 0],
  ["攻撃力Lv1", 1],
  ["攻撃Lv2", 3],
  ["攻撃Lv3", 7],
  ["攻撃Lv4", 13],
  ["攻撃Lv5", 21],
  ["攻撃Lv6", 31],
  ["攻撃Lv7", 44],
  ["攻撃Lv8", 60],
  ["攻撃Lv9", 79],
  ["攻撃Lv10", 100],
  ["攻撃力Lv1 DX", 250],
  ["攻撃力Lv1 ULT", 350],
  ["残酷な", 0],
  ["一撃の", 0],
  ["サナ", 0],
  ["最低攻撃Lv1", 4],
  ["最低攻撃Lv2", 10],
  ["最低攻撃Lv3", 22],
  ["最低攻撃Lv4", 40],
  ["最低攻撃Lv5", 64],
  ["最低攻撃Lv1 DX", 214],
  ["最低攻撃Lv1 ULT", 314],
  ["最高攻撃Lv1", 1],
  ["最高攻撃Lv2", 6],
  ["最高攻撃Lv3", 21],
  ["最高攻撃Lv4", 46],
  ["最高攻撃Lv5", 81],
  ["最高攻撃Lv1 DX", 231],
  ["最高攻撃Lv1 ULT", 331],
  ["防御力効率Lv1", 1],
  ["防御力効率Lv2", 3],
  ["防御力効率Lv3", 7],
  ["防御力効率Lv4", 13],
  ["防御力効率Lv5", 21],
  ["防御力効率Lv6", 31],
  ["防御力効率Lv7", 44],
  ["防御力効率Lv8", 60],
  ["防御力効率Lv9", 79],
  ["防御力効率Lv10", 100],
  ["防御効率Lv1 DX", 250],
  ["防御効率Lv1 ULT", 350],
  ["強固な", 0],
  ["守備隊の", 0],
  ["シュルト", 0],
  ["防御力Lv1", 5],
  ["防御力Lv2", 25],
  ["防御力Lv3", 45],
  ["防御力Lv4", 65],
  ["防御力Lv5", 85],
  ["防御力Lv1 DX", 235],
  ["防御力Lv1 ULT", 335],
  ["最大HP効率Lv1", 45],
  ["最大HP効率Lv2", 55],
  ["最大HP効率Lv3", 65],
  ["最大HP効率Lv4", 75],
  ["最大HP効率Lv5", 85],
  ["最大HP効率Lv6", 95],
  ["HP効率Lv1 DX", 245],
  ["HP効率Lv1 ULT", 345],
  ["覇気の", 0],
  ["堂々たる", 0],
  ["タポ", 0],
  ["最大HPLv1", 1],
  ["最大HPLv2", 2],
  ["最大HPLv3", 4],
  ["最大HPLv4", 7],
  ["最大HPLv5", 11],
  ["最大HPLv6", 16],
  ["最大HPLv7", 23],
  ["最大HPLv8", 32],
  ["最大HPLv9", 43],
  ["最大HPLv10", 56],
  ["最大HPLv11", 71],
  ["最大HPLv1 DX", 221],
  ["最大HPLv1 ULT", 321],
  ["最大CP効率Lv1", 35],
  ["最大CP効率Lv2", 47],
  ["最大CP効率Lv3", 59],
  ["最大CP効率Lv4", 71],
  ["最大CP効率Lv5", 83],
  ["最大CP効率Lv6", 95],
  ["CP効率Lv1 DX", 245],
  ["CP効率Lv1 ULT", 345],
  ["ケイルン", 0],
  ["最大CPLv1", 1],
  ["最大CPLv2", 2],
  ["最大CPLv3", 4],
  ["最大CPLv4", 7],
  ["最大CPLv5", 11],
  ["最大CPLv6", 16],
  ["最大CPLv7", 22],
  ["最大CPLv8", 29],
  ["最大CPLv9", 37],
  ["最大CPLv10", 46],
  ["最大CPLv11", 56],
  ["最大CPLv1 DX", 206],
  ["最大CPLv1 ULT", 306],
  ["CP減少抑止Lv1", 47],
  ["CP減少抑止Lv2", 66],
  ["CP減少抑止Lv3", 85],
  ["CP減抑止Lv1 DX", 235],
  ["CP減抑止Lv1 ULT", 335],
  ["攻撃命中Lv1", 10],
  ["攻撃命中Lv2", 25],
  ["攻撃命中Lv3", 40],
  ["攻撃命中Lv4", 55],
  ["攻撃命中Lv5", 70],
  ["攻撃命中Lv6", 85],
  ["攻撃命中Lv1 DX", 285],
  ["攻撃命中Lv1 ULT", 385],
  ["バイル", 0],
  ["攻撃回避Lv1", 15],
  ["攻撃回避Lv2", 30],
  ["攻撃回避Lv3", 45],
  ["攻撃回避Lv4", 60],
  ["攻撃回避Lv5", 75],
  ["攻撃回避Lv6", 90],
  ["攻撃回避Lv1 DX", 290],
  ["攻撃回避Lv1 ULT", 390],
  ["アリエル", 0],
  ["ブロック率Lv1", 5],
  ["ブロック率Lv2", 18],
  ["ブロック率Lv3", 39],
  ["ブロック率Lv4", 80],
  ["ブロックLv1 DX", 280],
  ["ブロックLv1 ULT", 380],
  ["致命打率Lv1", 7],
  ["致命打率Lv2", 57],
  ["致命打率Lv1 DX", 257],
  ["致命打率Lv1 ULT", 357],
  ["オベ", 0],
  ["決定打率Lv1", 33],
  ["決定打率Lv2", 66],
  ["回避補正無視", 99],
  ["命中補正無視", 99],
  ["絶対命中", 100],
  ["防御速度Lv1", 10],
  ["防御速度Lv2", 30],
  ["移動速度Lv1", 5],
  ["移動速度Lv2", 20],
  ["移動速度Lv3", 40],
  ["移動速度Lv4", 55],
  ["移動速度Lv5", 60],
  ["移動速度Lv1 DX", 210],
  ["移動速度Lv1 ULT", 310],
  ["ニケ", 0],
  ["攻撃速度Lv1", 40],
  ["攻撃速度Lv2", 65],
  ["攻撃速度Lv3", 70],
  ["攻撃速度Lv1 DX", 270],
  ["攻撃速度Lv1 ULT", 370],
  ["憤怒の", 0],
  ["追跡者の", 0],
  ["ペル", 0],
  ["薬回復Lv1", 10],
  ["薬回復Lv2", 15],
  ["薬回復Lv3", 30],
  ["CP減少速度Lv1", 30],
  ["CP減少速度Lv2", 60],
  ["CP減少速度Lv3", 90],
  ["CP減速Lv1 DX", 240],
  ["CP減速Lv1 ULT", 340],
  ["火属性攻撃Lv1", 6],
  ["火属性攻撃Lv2", 8],
  ["火属性攻撃Lv3", 12],
  ["火属性攻撃Lv4", 18],
  ["火属性攻撃Lv5", 26],
  ["火属性攻撃Lv6", 36],
  ["火属性攻撃Lv7", 48],
  ["火属性攻撃Lv8", 62],
  ["火属性攻撃Lv9", 78],
  ["火属性攻撃Lv10", 96],
  ["火攻撃Lv1 DX", 196],
  ["火攻撃Lv1 ULT", 296],
  ["水属性攻撃Lv1", 7],
  ["水属性攻撃Lv2", 9],
  ["水属性攻撃Lv3", 13],
  ["水属性攻撃Lv4", 19],
  ["水属性攻撃Lv5", 27],
  ["水属性攻撃Lv6", 37],
  ["水属性攻撃Lv7", 49],
  ["水属性攻撃Lv8", 63],
  ["水属性攻撃Lv9", 79],
  ["水属性攻撃Lv10", 97],
  ["水攻撃Lv1 DX", 197],
  ["水攻撃Lv1 ULT", 297],
  ["風属性攻撃Lv1", 8],
  ["風属性攻撃Lv2", 10],
  ["風属性攻撃Lv3", 14],
  ["風属性攻撃Lv4", 20],
  ["風属性攻撃Lv5", 28],
  ["風属性攻撃Lv6", 38],
  ["風属性攻撃Lv7", 50],
  ["風属性攻撃Lv8", 64],
  ["風属性攻撃Lv9", 80],
  ["風属性攻撃Lv10", 98],
  ["風攻撃Lv1 DX", 198],
  ["風攻撃Lv1 ULT", 298],
  ["土属性攻撃Lv1", 9],
  ["土属性攻撃Lv2", 11],
  ["土属性攻撃Lv3", 15],
  ["土属性攻撃Lv4", 21],
  ["土属性攻撃Lv5", 29],
  ["土属性攻撃Lv6", 39],
  ["土属性攻撃Lv7", 51],
  ["土属性攻撃Lv8", 65],
  ["土属性攻撃Lv9", 81],
  ["土属性攻撃Lv10", 99],
  ["土攻撃Lv1 DX", 199],
  ["土攻撃Lv1 ULT", 299],
  ["光属性攻撃Lv1", 10],
  ["光属性攻撃Lv2", 12],
  ["光属性攻撃Lv3", 16],
  ["光属性攻撃Lv4", 22],
  ["光属性攻撃Lv5", 30],
  ["光属性攻撃Lv6", 40],
  ["光属性攻撃Lv7", 52],
  ["光属性攻撃Lv8", 66],
  ["光属性攻撃Lv9", 82],
  ["光属性攻撃Lv10", 100],
  ["光攻撃Lv1 DX", 200],
  ["光攻撃Lv1 ULT", 300],
  ["闇属性攻撃Lv1", 10],
  ["闇属性攻撃Lv2", 12],
  ["闇属性攻撃Lv3", 16],
  ["闇属性攻撃Lv4", 22],
  ["闇属性攻撃Lv5", 30],
  ["闇属性攻撃Lv6", 40],
  ["闇属性攻撃Lv7", 52],
  ["闇属性攻撃Lv8", 66],
  ["闇属性攻撃Lv9", 82],
  ["闇属性攻撃Lv10", 100],
  ["闇攻撃Lv1 DX", 200],
  ["闇攻撃Lv1 ULT", 300],
  ["HP吸収Lv1", 13],
  ["HP吸収Lv2", 33],
  ["HP吸収Lv3", 63],
  ["HP吸収Lv4", 73],
  ["CPボーナスLv1", 6],
  ["CPボーナスLv2", 26],
  ["CPボーナスLv3", 46],
  ["CPボーナスLv4", 66],
  ["敵逃亡", 40],
  ["ノックアウト", 50],
  ["即死Lv1", 55],
  ["即死Lv2", 75],
  ["武器破壊Lv1", 20],
  ["武器破壊Lv2", 50],
  ["防具破壊Lv1", 10],
  ["防具破壊Lv2", 30],
  ["コールドLv1", 22],
  ["コールドLv2", 44],
  ["フリーズLv1", 33],
  ["フリーズLv2", 55],
  ["暗闇", 4],
  ["スタン", 65],
  ["石化Lv1", 18],
  ["石化Lv2", 38],
  ["混乱Lv1", 12],
  ["混乱Lv2", 24],
  ["眠り", 13],
  ["魅了Lv1", 47],
  ["魅了Lv2", 74],
  ["ターゲット固定", 37],
  ["知能低下", 16],
  ["狂気", 7],
  ["火属性抵抗Lv1", 3],
  ["火属性抵抗Lv2", 7],
  ["火属性抵抗Lv3", 15],
  ["火属性抵抗Lv4", 27],
  ["火属性抵抗Lv5", 43],
  ["火属性抵抗Lv6", 63],
  ["火抵抗Lv1 DX", 213],
  ["火抵抗Lv1 ULT", 313],
  ["水属性抵抗Lv1", 4],
  ["水属性抵抗Lv2", 8],
  ["水属性抵抗Lv3", 16],
  ["水属性抵抗Lv4", 28],
  ["水属性抵抗Lv5", 44],
  ["水属性抵抗Lv6", 64],
  ["水抵抗Lv1 DX", 214],
  ["水抵抗Lv1 ULT", 314],
  ["風属性抵抗Lv1", 5],
  ["風属性抵抗Lv2", 9],
  ["風属性抵抗Lv3", 17],
  ["風属性抵抗Lv4", 29],
  ["風属性抵抗Lv5", 45],
  ["風属性抵抗Lv6", 65],
  ["風抵抗Lv1 DX", 215],
  ["風抵抗Lv1 ULT", 315],
  ["土属性抵抗Lv1", 6],
  ["土属性抵抗Lv2", 10],
  ["土属性抵抗Lv3", 18],
  ["土属性抵抗Lv4", 30],
  ["土属性抵抗Lv5", 46],
  ["土属性抵抗Lv6", 66],
  ["土抵抗Lv1 DX", 216],
  ["土抵抗Lv1 ULT", 316],
  ["光属性抵抗Lv1", 7],
  ["光属性抵抗Lv2", 11],
  ["光属性抵抗Lv3", 19],
  ["光属性抵抗Lv4", 31],
  ["光属性抵抗Lv5", 47],
  ["光属性抵抗Lv6", 67],
  ["光抵抗Lv1 DX", 217],
  ["光抵抗Lv1 ULT", 317],
  ["闇属性抵抗Lv1", 7],
  ["闇属性抵抗Lv2", 11],
  ["闇属性抵抗Lv3", 19],
  ["闇属性抵抗Lv4", 31],
  ["闇属性抵抗Lv5", 47],
  ["闇属性抵抗Lv6", 67],
  ["闇抵抗Lv1 DX", 217],
  ["闇抵抗Lv1 ULT", 317],
  ["全属性抵抗Lv1", 8],
  ["全属性抵抗Lv2", 24],
  ["全属性抵抗Lv3", 48],
  ["全属性抵抗Lv4", 80],
  ["全抵抗Lv1 DX", 280],
  ["全抵抗Lv1 ULT", 380],
  ["ソラ", 0],
  ["火属性吸収Lv1", 37],
  ["火属性吸収Lv2", 73],
  ["火吸収Lv1 DX", 253],
  ["火吸収Lv1 ULT", 353],
  ["水属性吸収Lv1", 38],
  ["水属性吸収Lv2", 74],
  ["水吸収Lv1 DX", 254],
  ["水吸収Lv1 ULT", 354],
  ["風属性吸収Lv1", 39],
  ["風属性吸収Lv2", 75],
  ["風吸収Lv1 DX", 255],
  ["風吸収Lv1 ULT", 355],
  ["土属性吸収Lv1", 40],
  ["土属性吸収Lv2", 76],
  ["土吸収Lv1 DX", 256],
  ["土吸収Lv1 ULT", 356],
  ["光属性吸収Lv1", 41],
  ["光属性吸収Lv2", 77],
  ["光吸収Lv1 DX", 257],
  ["光吸収Lv1 ULT", 357],
  ["闇属性吸収Lv1", 41],
  ["闇属性吸収Lv2", 77],
  ["闇吸収Lv1 DX", 257],
  ["闇吸収Lv1 ULT", 357],
  ["全属性吸収Lv1", 45],
  ["全属性吸収Lv2", 81],
  ["全吸収Lv1 DX", 281],
  ["全吸収Lv1 ULT", 381],
  ["フリーズ抵抗", 30],
  ["コールド抵抗", 15],
  ["スタン抵抗", 25],
  ["混乱抵抗", 10],
  ["魅了抵抗", 35],
  ["石化抵抗", 20],
  ["即死抵抗", 10],
  ["毒抵抗", 5],
  ["眠り抵抗", 1],
  ["状態異常抵抗", 40],
  ["状態系抵抗 DX", 190],
  ["状態系抵抗 ULT", 290],
  ["リラ", 0],
  ["低下系抵抗", 37],
  ["低下系抵抗 DX", 187],
  ["低下系抵抗 ULT", 287],
  ["呪い抵抗", 39],
  ["呪い抵抗 DX", 189],
  ["呪い抵抗 ULT", 289],
  ["全異常抵抗", 45],
  ["全異常抵抗 DX", 195],
  ["全異常抵抗 ULT", 295],
  ["後退転倒抵抗", 7],
  ["後退抵抗 DX", 157],
  ["後退抵抗 ULT", 257],
  ["致命打抵抗", 18],
  ["致命打抵抗 DX", 168],
  ["致命打抵抗 ULT", 268],
  ["決定打抵抗", 19],
  ["決定打抵抗 DX", 169],
  ["決定打抵抗 ULT", 269],
  ["攻撃反射Lv1", 3],
  ["攻撃反射Lv2", 8],
  ["攻撃反射Lv3", 29],
  ["攻撃反射Lv4", 47],
  ["CP変換Lv1", 2],
  ["CP変換Lv2", 9],
  ["CP変換Lv3", 53],
  ["反射フリーズ", 22],
  ["反射コールド", 19],
  ["剣士", 25],
  ["騎士", 45],
  ["聖騎士", 70],
  ["戦士", 25],
  ["剣闘士", 45],
  ["勇者", 70],
  ["霊感体質", 25],
  ["霊媒師", 45],
  ["神巫女", 70],
  ["拳士", 25],
  ["拳豪", 45],
  ["拳聖", 70],
  ["研究生", 24],
  ["魔法使い", 44],
  ["大魔導師", 69],
  ["闘犬", 26],
  ["牙狼", 46],
  ["銀狼", 71],
  ["図書委員", 24],
  ["司書", 44],
  ["上級司書", 69],
  ["司祭", 23],
  ["司教", 43],
  ["教主", 68],
  ["堕天使", 27],
  ["天使", 47],
  ["大天使", 72],
  ["メイド見習い", 21],
  ["メイド長", 41],
  ["メイドマスター", 66],
  ["盗人", 23],
  ["自由人", 43],
  ["怪盗", 68],
  ["格闘家", 24],
  ["師範代", 44],
  ["皆伝", 69],
  ["獣", 25],
  ["猛獣", 45],
  ["獣王", 70],
  ["狩人", 26],
  ["射手", 46],
  ["魔弓兵", 71],
  ["義勇兵", 26],
  ["傭兵", 46],
  ["魔槍兵", 71],
  ["魔法少女", 25],
  ["魔女", 45],
  ["暗黒魔女", 70],
  ["飼育者", 22],
  ["調教師", 42],
  ["団長", 67],
  ["精霊術士", 23],
  ["召喚士", 43],
  ["神獣使い", 68],
  ["ガンマン", 25],
  ["スナイパー", 45],
  ["拳銃王", 70],
  ["姫", 20],
  ["王妃", 40],
  ["女帝", 65],
  ["修行中", 21],
  ["アイドル", 41],
  ["大スター", 66],
  ["錬金術師", 25],
  ["大錬金術師", 45],
  ["王国錬金術師", 70],
  ["交霊術士", 25],
  ["死霊術師", 45],
  ["神霊術師", 70],
  ["小悪魔", 25],
  ["魔人", 45],
  ["魔王", 70],
  ["若船長", 25],
  ["船長", 45],
  ["大海賊", 70],
  ["達人", 30],
  ["名手", 50],
  ["大家", 75],
  ["RED STONE", 100],
  ["RED STONE DX", 300],
  ["RED STONE ULT", 400],
  ["名匠の", 0],
  ["探求的な", 0],
  ["ガスピル", 0],
  ["応急処置", 31],
  ["応急処置 DX", 181],
  ["応急処置 ULT", 281],
  ["変身速度", 3],
  ["変身速度 DX", 153],
  ["変身速度 ULT", 253],
  ["HP回復", 39],
  ["HP回復 DX", 239],
  ["HP回復 ULT", 339],
  ["復活確率", 25],
  ["不可視Lv1", 77],
  ["不可視Lv2", 88],
  ["浮遊", 32],
  ["魔法弾丸", 22],
  ["無限弾丸", 27],
  ["永久弾", 37],
  ["ターゲット回避", 46],
  ["魔具入手Lv1", 79],
  ["魔具入手Lv2", 89],
  ["魔具入手Lv3", 99],
  ["魔具入手Lv1 DX", 299],
  ["魔具入手Lv1 ULT", 399],
  ["ロングッシュ", 0],
  ["レア入手Lv1", 98],
  ["レア入手Lv2", 0],
  ["レア入手Lv3", 100],
  ["レア入手Lv1 DX", 300],
  ["考古学の", 400],
  ["ジョン・マルコ", 0],
  ["リロード速度", 2],
  ["リロード DX", 152],
  ["リロード ULT", 252],
  ["自動リロード", 14],
  ["スキルLv1 EX", 0],
  ["スキルLv2 EX", 0],
  ["スキルLv3 EX", 0],
  ["スキルLv4 EX", 0],
  ["スキルLv5 EX", 0],
  ["サマナーLv1 EX", 0],
  ["サマナーLv2 EX", 0],
  ["サマナーLv3 EX", 0],
  ["サマナーLv4 EX", 0],
  ["サマナーLv5 EX", 0],
  ["ペットLv1 EX", 0],
  ["ペットLv2 EX", 0],
  ["ペットLv3 EX", 0],
  ["ペットLv4 EX", 0],
  ["ペットLv5 EX", 0],
  ["魔力の", 250],
  ["ネルバ", 0],
  ["魔神の", 400],
  ["痛烈の", 200],
  ["ホーク", 0],
  ["鋭い", 400],
  ["忍耐の", 195],
  ["エステル", 0],
  ["辛苦の", 400],
  ["剛断の", 195],
  ["ベリータ", 0],
  ["堅実な", 400],
  ["薬回復Lv1 DX", 180],
  ["薬回復Lv1 ULT", 280],
  ["圧倒的な", 150],
  ["強打の", 150],
  ["熱狂的な", 150],
  ["崩しの", 150],
  ["超越の", 150],
  ["巧みな", 150],
  ["庇護の", 150],
  ["交感の", 150],
  ["指揮の", 150],
  ["抵抗の", 150],
  ["鈍感の", 150],
  ["再生の", 150],
  ["克服の", 150],
  ["狂暴の", 50],
  ["節制の", 50],
  ["極意の", 50],
  ["渇きの", 50],
  ["信義の", 50],
  ["耐性の", 50],
  ["恩寵の", 50],
  ["武装の", 50],
  ["迅速の", 50],
  ["次元の", 50],
  ["征服する", 45],
  ["力固定増強", 400],
  ["敏捷固定増強", 400],
  ["健康固定増強", 400],
  ["知識固定増強", 400],
  ["知恵固定増強", 400],
  ["威厳増強", 400],
  ["運増強", 400],
  ["攻撃力増強", 400],
  ["防御効率増強", 400],
  ["最大HP効率増強", 400],
  ["最大CP増強", 400],
  ["技術増強", 400],
  ["魔力増強", 400],
  ["攻撃速度増強", 400],
  ["移動速度増強", 400],
  ["攻撃命中増強", 400],
  ["攻撃回避増強", 400],
  ["致命打率増強", 400],
]);

const init = () => {
  const oplist = document.getElementById("oplist");
  for (const key of opMap.keys()) {
    const option = document.createElement("option");
    option.value = key;
    oplist.appendChild(option);
  }
};

const doit = () => {
  for (const i of [1, 2, 3]) {
    const selected = document.getElementById(`op${i}-sel`).value;
    const lv = opMap.get(selected);
    if (lv !== undefined) {
      document.getElementById(`op${i}`).value = lv;
    }
  }

  const base = parseInt(document.getElementById("base").value) || 0;
  const nx_minus = parseInt(document.getElementById("nx_minus").value) || 0;
  const badge_minus =
    parseInt(document.getElementById("badge_minus").value) || 0;
  const op1 = parseInt(document.getElementById("op1").value);
  const op2 = parseInt(document.getElementById("op2").value);
  const op3 = parseInt(document.getElementById("op3").value);
  const method = document.getElementById("method").value;

  const ops = [op1, op2, op3].sort((a, b) => {
    if (isNaN(a)) return 1;
    else if (isNaN(b)) return -1;
    else return b - a;
  });
  let item = base - nx_minus - badge_minus;
  if (method == "UM") {
    if (!isNaN(ops[2])) {
      item +=
        Math.trunc((ops[0] * 3) / 4) +
        Math.trunc(ops[1] / 4) +
        Math.trunc(ops[2] / 20);
    } else if (!isNaN(ops[1])) {
      item += Math.trunc((ops[0] * 3) / 4) + Math.trunc(ops[1] / 4);
    } else if (!isNaN(ops[0])) {
      item += ops[0];
    }
  } else {
    if (!isNaN(ops[0])) item += ops[0];
    if (!isNaN(ops[1])) item += Math.trunc((ops[1] * 2) / 3);
    if (!isNaN(ops[2])) item += Math.trunc((ops[2] * 1) / 3);
  }
  document.getElementById("out").innerText = Math.max(0, item);

  storage.save();
};

document.addEventListener("DOMContentLoaded", () => {
  init();
  const clear = (event) => {
    document.getElementById(event.target.id.replace("-sel", "")).value = "";
    doit();
  };
  document.querySelectorAll("input[type='search']").forEach((e, k, p) => {
    e.addEventListener("search", clear);
  });
  storage.addChildrenEventListener("input", doit);
  storage.apply();
  doit();
});
