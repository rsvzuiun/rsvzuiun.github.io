---
date: 2023-05-10T21:55:19+09:00
title: "対人物理ダメージの倍率期待値"
tags: ["GV", "物理ダメ"]
math: true
---

## TL;DR

* オーガ導入時の致命打発動確率の期待値は $6/23$
  * ダブクリの場合のダメージ倍率の期待値は $\times 41/23 = \times 1.7826$
  * ダブクリ+クルーエルの場合の同上は $\times 2.2$
* 暴走導入時のダメージ倍率の期待値は $\times 1.15$

仮に白ダメージ 1000 の場合、ダメージ倍率の期待値はそれぞれ以下のとおりとなる。
* オーガのみ: 1782.6
* オーガ・暴走: 2050 $(\times 1.12)$
* オーガ・クルーエル: 2200 $(\times 1.23)$
* オーガ・クルーエル・暴走: 2530 $(\times 1.42)$

## 図案書「オーガの騒動」

図案書「オーガの騒動」5セット効果のゲーム内テキストは以下のとおり。

> スキル命中時、15％ 確率で次のスキル2回間
> * 物理攻撃力 100％増加
> * クリティカル発動確率 100％増加

致命打抵抗が十分高い相手に対して、
* 奇数回だけの致命打が発生しないこと
* 4回連続の致命打が発生すること

から、「オーガ発動後1回目の致命打攻撃時はオーガの抽選がされない」ことを仮定して、
致命打発動率の期待値を計算する。

$p(n)$ を $n$ 回目の攻撃時にオーガが発動する確率として、
$p(n\le0) = 0$ とすると
<p>
$$
\begin{aligned}
p(n+1) &= 0 \cdot p(n) + 0.15 \cdot \{1 - p(n)\} \\
       &= 0.15 \cdot \{1 - p(n)\} \\
p(n)   &= \frac{3}{23} - \frac{3}{23} \cdot \left(-\frac{3}{20}\right)^n \quad (n\ge 0)
\end{aligned}
$$</p>

$q(n)$ を $n$ 回目の攻撃時に致命打が発動する確率として、
<p>
$$
\begin{aligned}
q(n) &= p(n-1) + p(n-2) \\
     & = \begin{cases}
        0    & (n = 0)\\
        0.15 & (n = 1)\\
        (6/23) - (340/69) \cdot (-3/20)^n & (n \ge 2)
      \end{cases}\\
     &= [0;~ 0.15;~ 0.2775;~ 0.2584;~ 0.2612;~ 0.2608;~ 0.2609;~\dots] \\
     &\rightarrow 6/23 \approx 0.2609
\end{aligned}
$$</p>

この結果は以下のモンテカルロ法でも確認できる。

```py
from random import random

ogre = 0
crit = 0
N = 10**7
for i in range(N):
    if ogre > 0:
        ogre -= 1
        crit += 1
    if ogre == 0 and random() < 0.15:
        ogre = 2
print(crit / N)
```

白ダメージに対する倍率 $k$ は、
* ダブルクリティカルが出る場合
$$ k = 4 \cdot (6/23) + 1 \cdot (1 - 6/23) = 41/23 = 1.7826 $$
* ダブルクリティカルかつクルーエルの場合
$$ k = 1.4 \cdot 4 \cdot (6/23) + 1 \cdot (1 - 6/23) = 2.2 $$

## 超越スキル「魔力の暴走」

超越スキル「魔力の暴走」のゲーム内テキストは以下の通り。
> 一定の確率で、自身の攻撃力増加および魔法攻撃力増加に応じた数値によって限界ダメージを無視した追加ダメージが入る。 ※ 追加ダメージは最大 150％ 制限

結局のところ「10% の確率で 2.5倍のダメージを与える」と同義のため、
基底ダメージに対する倍率 $k$ は、
$$ k = 2.5 \cdot 1.10 + 1.0 \cdot (1 - 0.10) = 1.15 $$
